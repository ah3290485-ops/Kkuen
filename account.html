<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø­Ø³Ø§Ø¨ÙŠ</title>

<script src="https://unpkg.com/@supabase/supabase-js"></script>
<script src="supabase.js"></script>

<style>
body{
  margin:0;
  min-height:100vh;
  background:linear-gradient(160deg,#020617,#0f172a);
  font-family:Arial;
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
}

.box{
  width:90%;
  max-width:380px;
  background:#020617;
  padding:25px;
  border-radius:18px;
}

h2{
  text-align:center;
  color:gold;
  margin-bottom:20px;
}

.item{
  margin-bottom:15px;
  font-size:15px;
}

input{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:none;
  margin-top:6px;
}

button{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
  background:gold;
  font-weight:bold;
  font-size:16px;
  margin-top:10px;
}

.back{
  text-align:center;
  margin-top:15px;
}

.back a{
  color:gold;
  text-decoration:none;
}
</style>
</head>

<body>

<div class="box">
  <h2>ğŸ‘¤ Ø­Ø³Ø§Ø¨ÙŠ</h2>

  <div class="item">ğŸ“§ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„:
    <div id="email">...</div>
  </div>

  <div class="item">ğŸ†” Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨:
    <div id="userid">...</div>
  </div>

  <div class="item">ğŸ“… ØªØ§Ø±ÙŠØ® Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨:
    <div id="created">...</div>
  </div>

  <hr style="margin:20px 0;opacity:.2">

  <div class="item">
    ğŸ” ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
    <input id="newpass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©">
  </div>

  <button onclick="changePassword()">ØªØ­Ø¯ÙŠØ« ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</button>

  <div class="back">
    <a href="dashboard.html">â¬…ï¸ Ø±Ø¬ÙˆØ¹</a>
  </div>
</div>

<script>
async function loadAccount(){
  const { data: { user } } = await supabase.auth.getUser();

  if(!user){
    window.location.href="login.html";
    return;
  }

  document.getElementById("email").innerText = user.email;
  document.getElementById("userid").innerText = user.id;
  document.getElementById("created").innerText =
    new Date(user.created_at).toLocaleDateString();
}

async function changePassword(){
  const newPass = document.getElementById("newpass").value;

  if(newPass.length < 6){
    alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù„Ø§Ø²Ù… ØªÙƒÙˆÙ† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");
    return;
  }

  const { error } = await supabase.auth.updateUser({
    password: newPass
  });

  if(error){
    alert(error.message);
  }else{
    alert("ØªÙ… ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ù†Ø¬Ø§Ø­ âœ…");
    document.getElementById("newpass").value="";
  }
}

loadAccount();
</script>

</body>
</html>
